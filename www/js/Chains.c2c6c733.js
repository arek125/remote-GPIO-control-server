(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Chains"],{"3fb9":function(a,t,e){"use strict";var o=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"toast toast-error"},[e("button",{staticClass:"btn btn-clear float-right",on:{click:function(t){return a.$emit("close-err")}}}),""!==a.errorMessage&&null!==a.errorMessage?e("span",[a._v(" "+a._s(a.errorMessage)+" ")]):a._e(),a.errorArray.length&&null!==a.errorArray?e("ul",a._l(a.errorArray,(function(t,o){return e("li",{key:o},[a._v(a._s(t))])})),0):a._e()])},s=[],n={name:"Error",props:{errorMessage:{type:String,required:!1},errorArray:{default:()=>[],type:Array,required:!1}}},i=n,l=e("2877"),d=Object(l["a"])(i,o,s,!1,null,null,null);t["a"]=d.exports},"49a3":function(a,t,e){"use strict";var o=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("div",{staticClass:"panel"},[e("div",{staticClass:"panel-header"},[a._m(0),null!==a.$route.meta.error?e("Error",{attrs:{"error-message":a.$route.meta.error},on:{"close-err":function(t){a.$route.meta.error=null,a.$forceUpdate()}}}):a._e()],1),e("div",{staticClass:"panel-nav"},[e("div",{staticClass:"input-group filter"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.dateFrom,expression:"dateFrom"}],staticClass:"form-input input-sm",attrs:{type:"date",placeholder:"Date from"},domProps:{value:a.dateFrom},on:{input:function(t){t.target.composing||(a.dateFrom=t.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:a.dateTo,expression:"dateTo"}],staticClass:"form-input input-sm",attrs:{type:"date",placeholder:"Date to"},domProps:{value:a.dateTo},on:{input:function(t){t.target.composing||(a.dateTo=t.target.value)}}}),e("button",{staticClass:"btn input-group-btn btn-sm",on:{click:function(t){return a.getHistory()}}},[e("i",{staticClass:"icon icon-refresh centered"})])])]),e("div",{staticClass:"panel-body"},[a.history.length?e("table",{staticClass:"table table-striped"},[a._m(1),e("tbody",a._l(a.history,(function(t){return e("tr",{key:t.id},[e("td",[a._v(a._s(t.date))]),e("td",[a._v(a._s(t.name))]),e("td",[a._v(a._s(t.state))]),e("td",[a._v(a._s(t.by))])])})),0)]):e("div",{staticClass:"empty centered"},[a._m(2),e("p",{staticClass:"empty-title h5"},[a._v("There are is no data in the selected range")])])]),e("div",{staticClass:"panel-footer"},[e("span",{staticClass:"text-secondary"},[a._v("Last update: "+a._s(a.updateDate))]),e("div",{staticClass:"float-right tooltip tooltip-left",attrs:{"data-tooltip":"Auto refresh time (s)"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.autoRefreshTime,expression:"autoRefreshTime"}],staticClass:"form-input input-sm",attrs:{type:"number",id:"autorefresh"},domProps:{value:a.autoRefreshTime},on:{change:function(t){return a.autoRefresh()},input:function(t){t.target.composing||(a.autoRefreshTime=t.target.value)}}})])])])])},s=[function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"panel-title"},[e("h3",[a._v("History")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("thead",[e("tr",[e("th",[a._v("Date")]),e("th",[a._v("Name")]),e("th",[a._v("Action")]),e("th",[a._v("By")])])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"empty-icon"},[e("i",{staticClass:"icon icon-4x icon-cross"})])}],n=e("3fb9"),i={name:"History",data(){return{history:[],refreshInterval:"",updateDate:"",autoRefreshTime:5,dateFrom:"",dateTo:""}},props:["category"],created(){this.dateFrom=this.$moment().subtract(7,"days").format("YYYY-MM-DD"),this.dateTo=this.$moment().add(1,"days").format("YYYY-MM-DD"),this.getHistory(),this.$cookies.isKey("hr_arTime")&&(this.autoRefreshTime=parseInt(this.$cookies.get("hr_arTime"))),this.autoRefresh()},beforeDestroy(){clearTimeout(this.refreshInterval)},methods:{autoRefresh(){this.$cookies.set("hr_arTime",this.autoRefreshTime,-1),clearTimeout(this.refreshInterval),this.autoRefreshTime>0&&(this.refreshInterval=setTimeout(()=>{this.getHistory(),this.autoRefresh()},1e3*this.autoRefreshTime))},getHistory(){this.dateFrom&&this.dateTo&&this.doPost("HR_selByCat;"+this.$moment(this.dateFrom,"YYYY-MM-DD").utc().format("YYYY-MM-DD")+";"+this.$moment(this.dateTo+" 23:59:59","YYYY-MM-DD HH:mm:ss").utc().format("YYYY-MM-DD")+";"+this.category).then(a=>{this.$route.meta.error=null,this.history=[];for(var t=2;t<a.length-1;t+=5)this.history.push({id:parseInt(a[t]),date:this.$moment.utc(a[t+1],"YYYY-MM-DD HH:mm:ss").local().format("YYYY-MM-DD HH:mm:ss"),by:a[t+2],name:a[t+3],state:a[t+4]});this.updateDate=this.$moment().format("YYYY-MM-DD HH:mm:ss.SSS")}).catch(a=>{this.$route.meta.error=a.message,this.$forceUpdate()})}},components:{Error:n["a"]}},l=i,d=e("2877"),r=Object(d["a"])(l,o,s,!1,null,null,null);t["a"]=r.exports},"890f":function(a,t,e){"use strict";e.r(t);var o=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"Chains"},[null!==a.$route.meta.error?e("Error",{attrs:{"error-message":a.$route.meta.error},on:{"close-err":function(t){a.$route.meta.error=null,a.$forceUpdate()}}}):e("div",{staticClass:"container"},[e("div",{staticClass:"columns"},[e("Chain",{staticClass:"column col-8 col-md-12"}),e("History",{staticClass:"column col-4 col-md-12",attrs:{category:"chain"}})],1)])],1)},s=[],n=e("3fb9"),i=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("div",{staticClass:"panel"},[e("div",{staticClass:"panel-header"},[a._m(0),null!==a.$route.meta.error?e("Error",{attrs:{"error-message":a.$route.meta.error},on:{"close-err":function(t){a.$route.meta.error=null,a.$forceUpdate()}}}):a._e()],1),e("div",{staticClass:"panel-nav"},[e("div",{staticClass:"btn-group btn-group-block float-right"},[e("button",{staticClass:"btn",on:{click:function(t){return a.getChains()}}},[e("i",{staticClass:"icon icon-refresh centered"})]),e("button",{staticClass:"btn",on:{click:function(t){return a.openChainModal("Add new execution chain","",-1,1,!0)}}},[e("i",{staticClass:"icon icon-plus centered"})])])]),e("div",{staticClass:"panel-body"},[e("div",{staticClass:"modal",class:{active:a.modalChainData.active}},[e("a",{staticClass:"modal-overlay",attrs:{"aria-label":"Close"},on:{click:function(t){a.modalChainData.active=!1}}}),e("div",{staticClass:"modal-container"},[e("div",{staticClass:"modal-header"},[e("a",{staticClass:"btn btn-clear float-right",attrs:{"aria-label":"Close"},on:{click:function(t){a.modalChainData.active=!1}}}),e("div",{staticClass:"modal-title h5"},[a._v(a._s(a.modalChainData.title))]),a.modalChainData.errors.length?e("Error",{attrs:{"error-array":a.modalChainData.errors},on:{"close-err":function(t){a.modalChainData.errors=[]}}}):a._e()],1),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"content"},[e("form",{staticClass:"form-horizontal"},[e("div",{staticClass:"form-group"},[a._m(1),e("div",{staticClass:"col-9 col-sm-12"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.modalChainData.name,expression:"modalChainData.name"}],staticClass:"form-input",attrs:{type:"text",id:"name",placeholder:"Name"},domProps:{value:a.modalChainData.name},on:{input:function(t){t.target.composing||a.$set(a.modalChainData,"name",t.target.value)}}})])]),e("div",{staticClass:"form-group"},[a._m(2),e("div",{staticClass:"col-9 col-sm-12"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.modalChainData.countdown,expression:"modalChainData.countdown"}],staticClass:"form-input",attrs:{type:"number",id:"countdown"},domProps:{value:a.modalChainData.countdown},on:{input:function(t){t.target.composing||a.$set(a.modalChainData,"countdown",t.target.value)}}}),e("p",{staticClass:"text-gray text-italic"},[a._v("-1 infinite, 0 disabled or any number for loop countdown")])])]),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.modalChainData.keepLogs,expression:"modalChainData.keepLogs"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.modalChainData.keepLogs)?a._i(a.modalChainData.keepLogs,null)>-1:a.modalChainData.keepLogs},on:{change:function(t){var e=a.modalChainData.keepLogs,o=t.target,s=!!o.checked;if(Array.isArray(e)){var n=null,i=a._i(e,n);o.checked?i<0&&a.$set(a.modalChainData,"keepLogs",e.concat([n])):i>-1&&a.$set(a.modalChainData,"keepLogs",e.slice(0,i).concat(e.slice(i+1)))}else a.$set(a.modalChainData,"keepLogs",s)}}}),e("i",{staticClass:"form-icon"}),a._v("Keep logs ")])])])])]),e("div",{staticClass:"modal-footer"},[e("button",{directives:[{name:"show",rawName:"v-show",value:-1!==a.modalChainData.id,expression:"modalChainData.id !== -1"}],staticClass:"btn btn-code float-left",attrs:{disabled:this.loading},on:{click:function(t){return a.modalChainAction(!0)}}},[e("i",{staticClass:"icon icon-delete"}),a._v(" Delete")]),e("button",{staticClass:"btn btn-primary",attrs:{disabled:this.loading},on:{click:function(t){return a.modalChainAction(!1)}}},[e("i",{staticClass:"icon icon-check"}),a._v(" Confirm")])])])]),e("div",{staticClass:"modal",class:{active:a.modalBondData.active}},[e("a",{staticClass:"modal-overlay",attrs:{"aria-label":"Close"},on:{click:function(t){a.modalBondData.active=!1}}}),e("div",{staticClass:"modal-container"},[e("div",{staticClass:"modal-header"},[e("a",{staticClass:"btn btn-clear float-right",attrs:{"aria-label":"Close"},on:{click:function(t){a.modalBondData.active=!1}}}),e("div",{staticClass:"modal-title h5"},[a._v(a._s(a.modalBondData.title))]),a.modalBondData.errors.length?e("Error",{attrs:{"error-array":a.modalBondData.errors},on:{"close-err":function(t){a.modalBondData.errors=[]}}}):a._e()],1),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"content"},[e("form",{staticClass:"form-horizontal"},[e("div",{staticClass:"form-group"},[a._m(3),e("div",{staticClass:"col-9 col-sm-12"},[e("select",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.type,expression:"modalBondData.type"}],staticClass:"form-select",attrs:{id:"type"},on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.modalBondData,"type",t.target.multiple?e:e[0])}}},[e("option",{attrs:{value:"output"}},[a._v("Output")]),e("option",{attrs:{value:"pwm"}},[a._v("PWM")]),e("option",{attrs:{value:"action"}},[a._v("Check and run automated action")]),e("option",{attrs:{value:"rfsend"}},[a._v("Transmit RF Code")]),e("option",{attrs:{value:"cmd"}},[a._v("Execute custom command")]),e("option",{attrs:{value:"chain"}},[a._v("Execute or cancel other chain")]),e("option",{attrs:{value:"var"}},[a._v("Set global variable")]),e("option",{attrs:{value:"action_noe"}},[a._v("Set number of executions of automated action")]),e("option",{attrs:{value:"chain_ec"}},[a._v("Set chain execution countdown")])])])]),e("div",{staticClass:"form-group"},[a._m(4),e("div",{staticClass:"col-9 col-sm-12"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.deley,expression:"modalBondData.deley"}],staticClass:"form-input",attrs:{min:"0",type:"number",id:"deley",placeholder:"Single GPIO BCM number"},domProps:{value:a.modalBondData.deley},on:{input:function(t){t.target.composing||a.$set(a.modalBondData,"deley",t.target.value)}}})])]),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.bondLinked,expression:"modalBondData.bondLinked"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.modalBondData.bondLinked)?a._i(a.modalBondData.bondLinked,null)>-1:a.modalBondData.bondLinked},on:{change:[function(t){var e=a.modalBondData.bondLinked,o=t.target,s=!!o.checked;if(Array.isArray(e)){var n=null,i=a._i(e,n);o.checked?i<0&&a.$set(a.modalBondData,"bondLinked",e.concat([n])):i>-1&&a.$set(a.modalBondData,"bondLinked",e.slice(0,i).concat(e.slice(i+1)))}else a.$set(a.modalBondData,"bondLinked",s)},function(t){a.modalBondData.linkId=0,a.reFetchTargetsData()}]}}),e("i",{staticClass:"form-icon"}),a._v("Linked pi execute? ")])]),a.modalBondData.bondLinked?e("div",{staticClass:"form-group",class:{"has-error":!a.modalBondData.linkedPis.length}},[a._m(5),e("div",{staticClass:"col-9 col-sm-12 has-icon-left"},[e("select",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.linkId,expression:"modalBondData.linkId"}],staticClass:"form-select",on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.modalBondData,"linkId",t.target.multiple?e:e[0])},function(t){return a.reFetchTargetsData()}]}},a._l(a.modalBondData.linkedPis,(function(t){return e("option",{key:t.id,domProps:{value:t.id}},[a._v(a._s(t.name))])})),0),e("i",{staticClass:"form-icon",class:{loading:a.loading}}),e("p",{directives:[{name:"show",rawName:"v-show",value:!a.modalBondData.linkedPis.length&&!a.loading,expression:"!modalBondData.linkedPis.length && !loading"}],staticClass:"form-input-hint"},[a._v("Add linked pis devices to make them pickable here.")])])]):a._e(),"output"==a.modalBondData.type?e("div",{staticClass:"form-group",class:{"has-error":!a.modalBondData.outputs.length}},[a._m(6),e("div",{staticClass:"col-9 col-sm-12 has-icon-left"},[e("select",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.outputId,expression:"modalBondData.outputId"}],staticClass:"form-select",on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.modalBondData,"outputId",t.target.multiple?e:e[0])}}},a._l(a.modalBondData.outputs,(function(t){return e("option",{key:t.id,domProps:{value:t.id}},[a._v(a._s(t.name))])})),0),e("i",{staticClass:"form-icon",class:{loading:a.loading}}),e("p",{directives:[{name:"show",rawName:"v-show",value:!a.modalBondData.outputs.length&&!a.loading,expression:"!modalBondData.outputs.length && !loading"}],staticClass:"form-input-hint"},[a._v("Add outputs to make them pickable here.")])])]):"pwm"==a.modalBondData.type?e("div",{staticClass:"form-group",class:{"has-error":!a.modalBondData.pwms.length}},[a._m(7),e("div",{staticClass:"col-9 col-sm-12 has-icon-left"},[e("select",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.pwmId,expression:"modalBondData.pwmId"}],staticClass:"form-select",on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.modalBondData,"pwmId",t.target.multiple?e:e[0])}}},a._l(a.modalBondData.pwms,(function(t){return e("option",{key:t.id,domProps:{value:t.id}},[a._v(a._s(t.name))])})),0),e("i",{staticClass:"form-icon",class:{loading:a.loading}}),e("p",{directives:[{name:"show",rawName:"v-show",value:!a.modalBondData.pwms.length&&!a.loading,expression:"!modalBondData.pwms.length && !loading"}],staticClass:"form-input-hint"},[a._v("Add PWM's to make them pickable here.")])])]):"action"==a.modalBondData.type?e("div",{staticClass:"form-group",class:{"has-error":!a.modalBondData.actions.length}},[a._m(8),e("div",{staticClass:"col-9 col-sm-12 has-icon-left"},[e("select",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.actionId,expression:"modalBondData.actionId"}],staticClass:"form-select",on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.modalBondData,"actionId",t.target.multiple?e:e[0])}}},a._l(a.modalBondData.actions,(function(t){return e("option",{key:t.id,domProps:{value:t.id}},[a._v(a._s(t.name))])})),0),e("i",{staticClass:"form-icon",class:{loading:a.loading}}),e("p",{directives:[{name:"show",rawName:"v-show",value:!a.modalBondData.actions.length&&!a.loading,expression:"!modalBondData.actions.length && !loading"}],staticClass:"form-input-hint"},[a._v("Add actions to make them pickable here.")])])]):"rfsend"==a.modalBondData.type?e("div",{staticClass:"form-group",class:{"has-error":!a.modalBondData.rfCodes.length}},[a._m(9),e("div",{staticClass:"col-9 col-sm-12 has-icon-left"},[e("select",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.rfId,expression:"modalBondData.rfId"}],staticClass:"form-select",on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.modalBondData,"rfId",t.target.multiple?e:e[0])}}},a._l(a.modalBondData.rfCodes,(function(t){return e("option",{key:t.id,domProps:{value:t.id}},[a._v(a._s(t.name))])})),0),e("i",{staticClass:"form-icon",class:{loading:a.loading}}),e("p",{directives:[{name:"show",rawName:"v-show",value:!a.modalBondData.rfCodes.length&&!a.loading,expression:"!modalBondData.rfCodes.length && !loading"}],staticClass:"form-input-hint"},[a._v("Add RF codes to make them pickable here.")])])]):"cmd"==a.modalBondData.type?e("div",{staticClass:"form-group",class:{"has-error":!a.modalBondData.cmds.length}},[a._m(10),e("div",{staticClass:"col-9 col-sm-12 has-icon-left"},[e("select",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.cmdId,expression:"modalBondData.cmdId"}],staticClass:"form-select",on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.modalBondData,"cmdId",t.target.multiple?e:e[0])}}},a._l(a.modalBondData.cmds,(function(t){return e("option",{key:t.id,domProps:{value:t.id}},[a._v(a._s(t.name))])})),0),e("i",{staticClass:"form-icon",class:{loading:a.loading}}),e("p",{directives:[{name:"show",rawName:"v-show",value:!a.modalBondData.cmds.length&&!a.loading,expression:"!modalBondData.cmds.length && !loading"}],staticClass:"form-input-hint"},[a._v("Add cmd commands to make them pickable here.")])])]):"chain"==a.modalBondData.type?e("div",{staticClass:"form-group",class:{"has-error":!a.modalBondData.chains.length}},[a._m(11),e("div",{staticClass:"col-9 col-sm-12 has-icon-left"},[e("select",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.exeChainId,expression:"modalBondData.exeChainId"}],staticClass:"form-select",on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.modalBondData,"exeChainId",t.target.multiple?e:e[0])}}},a._l(a.modalBondData.chains,(function(t){return e("option",{key:t.id,domProps:{value:t.id}},[a._v(a._s(t.name))])})),0),e("i",{staticClass:"form-icon",class:{loading:a.loading}}),e("p",{directives:[{name:"show",rawName:"v-show",value:!a.modalBondData.chains.length&&!a.loading,expression:"!modalBondData.chains.length && !loading"}],staticClass:"form-input-hint"},[a._v("Add chains to make them pickable here.")])])]):"var"==a.modalBondData.type?e("div",{staticClass:"form-group",class:{"has-error":!a.modalBondData.vars.length}},[a._m(12),e("div",{staticClass:"col-4 col-sm-12 has-icon-left"},[e("select",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.varId,expression:"modalBondData.varId"}],staticClass:"form-select",on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.modalBondData,"varId",t.target.multiple?e:e[0])},function(t){a.modalBondData.selectedVarIndex=t.target.selectedIndex}]}},a._l(a.modalBondData.vars,(function(t){return e("option",{key:t.id,domProps:{value:t.id}},[a._v(a._s(t.name))])})),0),e("i",{staticClass:"form-icon",class:{loading:a.loading}}),e("p",{directives:[{name:"show",rawName:"v-show",value:!a.modalBondData.vars.length&&!a.loading,expression:"!modalBondData.vars.length && !loading"}],staticClass:"form-input-hint"},[a._v("Add global variables to make them pickable here.")])]),e("div",{staticClass:"col-1 col-sm-12",staticStyle:{"text-align":"center","padding-top":"5px"}},[a._v(" eq ")]),a.modalBondData.vars.length?e("div",{staticClass:"col-4 col-sm-12"},["String"==a.modalBondData.vars[a.modalBondData.selectedVarIndex].type?e("input",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.varValue,expression:"modalBondData.varValue"}],staticClass:"form-input",attrs:{type:"text",id:"val",placeholder:"Default value"},domProps:{value:a.modalBondData.varValue},on:{input:function(t){t.target.composing||a.$set(a.modalBondData,"varValue",t.target.value)}}}):"Date"==a.modalBondData.vars[a.modalBondData.selectedVarIndex].type?e("input",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.varValue,expression:"modalBondData.varValue"}],staticClass:"form-input",attrs:{type:"datetime-local",id:"val"},domProps:{value:a.modalBondData.varValue},on:{input:function(t){t.target.composing||a.$set(a.modalBondData,"varValue",t.target.value)}}}):"Time"==a.modalBondData.vars[a.modalBondData.selectedVarIndex].type?e("input",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.varValue,expression:"modalBondData.varValue"}],staticClass:"form-input",attrs:{type:"time",id:"val"},domProps:{value:a.modalBondData.varValue},on:{input:function(t){t.target.composing||a.$set(a.modalBondData,"varValue",t.target.value)}}}):e("input",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.varValue,expression:"modalBondData.varValue"}],staticClass:"form-input",attrs:{type:"number",id:"val"},domProps:{value:a.modalBondData.varValue},on:{input:function(t){t.target.composing||a.$set(a.modalBondData,"varValue",t.target.value)}}})]):a._e()]):"action_noe"==a.modalBondData.type?e("div",{staticClass:"form-group",class:{"has-error":!a.modalBondData.actions.length}},[a._m(13),e("div",{staticClass:"col-9 col-sm-12 has-icon-left"},[e("select",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.actionId,expression:"modalBondData.actionId"}],staticClass:"form-select",on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.modalBondData,"actionId",t.target.multiple?e:e[0])}}},a._l(a.modalBondData.actions,(function(t){return e("option",{key:t.id,domProps:{value:t.id}},[a._v(a._s(t.name))])})),0),e("i",{staticClass:"form-icon",class:{loading:a.loading}}),e("p",{directives:[{name:"show",rawName:"v-show",value:!a.modalBondData.actions.length&&!a.loading,expression:"!modalBondData.actions.length && !loading"}],staticClass:"form-input-hint"},[a._v("Add actions to make them pickable here.")])]),a._m(14),e("div",{staticClass:"col-9 col-sm-12"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.actionNOE,expression:"modalBondData.actionNOE"}],staticClass:"form-input",attrs:{type:"number",id:"noe",min:"-1"},domProps:{value:a.modalBondData.actionNOE},on:{input:function(t){t.target.composing||a.$set(a.modalBondData,"actionNOE",t.target.value)}}}),e("p",{staticClass:"text-gray text-italic"},[a._v("-1 unlimited, 0 disabled or any number for execution countdown")])])]):"chain_ec"==a.modalBondData.type?e("div",{staticClass:"form-group",class:{"has-error":!a.modalBondData.chains.length}},[a._m(15),e("div",{staticClass:"col-9 col-sm-12 has-icon-left"},[e("select",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.exeChainId,expression:"modalBondData.exeChainId"}],staticClass:"form-select",on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.modalBondData,"exeChainId",t.target.multiple?e:e[0])}}},a._l(a.modalBondData.chains,(function(t){return e("option",{key:t.id,domProps:{value:t.id}},[a._v(a._s(t.name))])})),0),e("i",{staticClass:"form-icon",class:{loading:a.loading}}),e("p",{directives:[{name:"show",rawName:"v-show",value:!a.modalBondData.chains.length&&!a.loading,expression:"!modalBondData.chains.length && !loading"}],staticClass:"form-input-hint"},[a._v("Add chains to make them pickable here.")])]),a._m(16),e("div",{staticClass:"col-9 col-sm-12"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.chainEC,expression:"modalBondData.chainEC"}],staticClass:"form-input",attrs:{type:"number",id:"ec",min:"-1"},domProps:{value:a.modalBondData.chainEC},on:{input:function(t){t.target.composing||a.$set(a.modalBondData,"chainEC",t.target.value)}}}),e("p",{staticClass:"text-gray text-italic"},[a._v("-1 infinite, 0 disabled or any number for loop countdown")])])]):a._e(),e("div",{directives:[{name:"show",rawName:"v-show",value:"output"==a.modalBondData.type||"pwm"==a.modalBondData.type||"chain"==a.modalBondData.type,expression:"modalBondData.type == 'output' || modalBondData.type == 'pwm' || modalBondData.type == 'chain'"}],staticClass:"form-group"},[a._m(17),e("div",{staticClass:"col-9 col-sm-12"},[e("select",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.state,expression:"modalBondData.state"}],staticClass:"form-select",attrs:{id:"state"},on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.modalBondData,"state",t.target.multiple?e:e[0])}}},[e("option",{attrs:{value:"0"}},[a._v("OFF")]),e("option",{attrs:{value:"1"}},[a._v("ON")]),e("option",{directives:[{name:"show",rawName:"v-show",value:"chain"!=a.modalBondData.type,expression:"modalBondData.type != 'chain'"}],attrs:{value:"2"}},[a._v("OPPOSITE")])])])]),e("div",{directives:[{name:"show",rawName:"v-show",value:"pwm"==a.modalBondData.type,expression:"modalBondData.type == 'pwm'"}],staticClass:"form-group"},[a._m(18),e("div",{staticClass:"col-9 col-sm-12"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.pwmFr,expression:"modalBondData.pwmFr"}],staticClass:"form-input",attrs:{type:"number",id:"fr"},domProps:{value:a.modalBondData.pwmFr},on:{input:function(t){t.target.composing||a.$set(a.modalBondData,"pwmFr",t.target.value)}}})])]),e("div",{directives:[{name:"show",rawName:"v-show",value:"pwm"==a.modalBondData.type,expression:"modalBondData.type == 'pwm'"}],staticClass:"form-group"},[a._m(19),e("div",{staticClass:"col-9 col-sm-12"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.modalBondData.pwmDc,expression:"modalBondData.pwmDc"}],staticClass:"form-input",attrs:{type:"number",id:"dc",min:"0",max:"100"},domProps:{value:a.modalBondData.pwmDc},on:{input:function(t){t.target.composing||a.$set(a.modalBondData,"pwmDc",t.target.value)}}})])])])])]),e("div",{staticClass:"modal-footer"},[e("button",{directives:[{name:"show",rawName:"v-show",value:-1!==a.modalBondData.id,expression:"modalBondData.id !== -1"}],staticClass:"btn btn-code float-left",attrs:{disabled:this.loading},on:{click:function(t){return a.modalBondAction(!0)}}},[e("i",{staticClass:"icon icon-delete"}),a._v(" Delete")]),e("button",{staticClass:"btn btn-primary",attrs:{disabled:this.loading},on:{click:function(t){return a.modalBondAction(!1)}}},[e("i",{staticClass:"icon icon-check"}),a._v(" Confirm")])])])]),e("div",{staticClass:"modal",class:{active:a.modalReorderData.active}},[e("a",{staticClass:"modal-overlay",attrs:{"aria-label":"Close"},on:{click:function(t){a.modalReorderData.active=!1}}}),e("div",{staticClass:"modal-container"},[e("div",{staticClass:"modal-header"},[e("a",{staticClass:"btn btn-clear float-right",attrs:{"aria-label":"Close"},on:{click:function(t){a.modalReorderData.active=!1}}}),e("div",{staticClass:"modal-title h5"},[a._v("Reorder bonds")]),a.modalReorderData.errors.length?e("Error",{attrs:{"error-array":a.modalReorderData.errors},on:{"close-err":function(t){a.modalReorderData.errors=[]}}}):a._e()],1),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"content"},[a.modalReorderData.bonds.length?e("dl",{staticClass:"list"},a._l(a.modalReorderData.bonds,(function(t,o){return e("dt",{key:t.id},[e("button",{staticClass:"btn btn-link",attrs:{disabled:0==o},on:{click:function(t){return a.reorder(!0,o)}}},[e("i",{staticClass:"icon icon-upward"})]),e("button",{staticClass:"btn btn-link",attrs:{disabled:o==a.modalReorderData.bonds.length-1},on:{click:function(t){return a.reorder(!1,o)}}},[e("i",{staticClass:"icon icon-downward"})]),"action"==t.type?e("span",[a._v(a._s(t.lp+". "+t.actionName+" Execute "+t.deley+"s"))]):"rfsend"==t.type?e("span",[a._v(a._s(t.lp+". "+t.rfName+" Transmit "+t.deley+"s"))]):"output"==t.type?e("span",[a._v(a._s(t.lp+". "+t.outputName+" "+a.outState(t.outputState)+" "+t.deley+"s"))]):"pwm"==t.type?e("span",[a._v(a._s(t.lp+". "+t.pwmName+" "+a.pwmState(t.pwmSs,t.pwmDc,t.pwmFr)+" "+t.deley+"s"))]):"cmd"==t.type?e("span",[a._v(a._s(t.lp+". "+t.cmdName+" Execute "+t.deley+"s"))]):"chain"==t.type?e("span",[a._v(a._s(t.lp+". "+(t.linkId?t.execChainName:a.findChain(t.execChainId).name)+(t.outputState?" Execute ":" Cancel ")+t.deley+"s"))]):"var"==t.type?e("span",[a._v(a._s(t.lp+". "+t.varName+" = "+t.varValue+" "+t.deley+"s"))]):"action_noe"==t.type?e("span",[a._v(a._s(t.actionName+" N.O.E. = "+t.actionNOE+" "+t.deley+"s"))]):"chain_ec"==t.type?e("span",[a._v(a._s((t.linkId?t.execChainName:a.findChain(t.execChainId).name)+" E.C. = "+t.chainEC+" "+t.deley+"s"))]):a._e()])})),0):e("div",[a._v("No bonds added.")])])]),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{disabled:this.loading},on:{click:function(t){return a.modalReorderAction()}}},[e("i",{staticClass:"icon icon-check"}),a._v(" Confirm")])])])]),e("div",{staticClass:"container"},[a.chains.length||a.loading?e("div",{staticClass:"columns"},a._l(a.chains,(function(t,o){return e("div",{key:t.id,staticClass:"column",class:[a.col]},[e("div",{staticClass:"tile"},[e("div",{staticClass:"tile-icon d-grid"},[e("button",{staticClass:"btn btn-action btn-lg",class:{"btn-success":!t.status&&t.bonds.length,"btn-warning":t.status,"btn-code":!t.status&&!t.bonds.length},attrs:{disabled:!t.bonds.length},on:{click:function(t){return a.execudeOrCancel(o)}}},[e("i",{staticClass:"icon icon-forward centered",class:{"icon-forward":!t.status,"icon-stop":t.status}})]),e("button",{staticClass:"btn btn-link",on:{click:function(e){return a.openChainModal("Edit: "+t.name,t.name,t.id,t.countdown,t.keepLogs)}}},[e("i",{staticClass:"icon icon-edit"})]),e("button",{staticClass:"btn btn-link",on:{click:function(e){return a.openBondModal("Add new chain bond",-1,t.id,"output",1,-1,-1,600,0,0,-1,-1,-1,0,-1)}}},[e("i",{staticClass:"icon icon-plus"})]),e("button",{staticClass:"btn btn-link",attrs:{disabled:t.bonds.length<2||t.status>0},on:{click:function(e){return a.openReorderModal(t.id,o,t.bonds)}}},[e("i",{staticClass:"icon icon-resize-vert"})])]),e("div",{staticClass:"tile-content"},[e("div",{staticClass:"tile-title"},[e("span",[a._v(a._s(t.name))])]),e("div",{staticClass:"tile-subtitle"},[t.bonds.length?e("ol",{staticClass:"list"},a._l(t.bonds,(function(o){return e("li",{key:o.id,class:{"text-warning":o.lp==t.status},on:{click:function(t){return a.openBondModal("Edit bond lp. "+o.lp,o.id,o.chainId,o.type,o.deley,o.outputId,o.pwmId,o.pwmFr,o.pwmDc,"pwm"==o.type?o.pwmSs:o.outputState,o.actionId,o.rfId,o.cmdId,o.linkId,o.execChainId,o.varId,o.varValue,o.actionNOE,o.chainEC)}}},["action"==o.type?e("button",{staticClass:"btn btn-link"},[a._v(a._s(o.actionName+" Execute "+o.deley+"s"))]):"output"==o.type?e("button",{staticClass:"btn btn-link"},[a._v(a._s(o.outputName+" "+a.outState(o.outputState)+" "+o.deley+"s"))]):"pwm"==o.type?e("button",{staticClass:"btn btn-link"},[a._v(a._s(o.pwmName+" "+a.pwmState(o.pwmSs,o.pwmDc,o.pwmFr)+" "+o.deley+"s"))]):"rfsend"==o.type?e("button",{staticClass:"btn btn-link"},[a._v(a._s(o.rfName+" Transmit "+o.deley+"s"))]):"cmd"==o.type?e("button",{staticClass:"btn btn-link"},[a._v(a._s(o.cmdName+" Execute "+o.deley+"s"))]):"chain"==o.type?e("button",{staticClass:"btn btn-link"},[a._v(a._s((o.linkId?o.execChainName:a.findChain(o.execChainId).name)+(o.outputState?" Execute ":" Cancel ")+o.deley+"s"))]):"var"==o.type?e("button",{staticClass:"btn btn-link"},[a._v(a._s(o.varName+" = "+o.varValue+" "+o.deley+"s"))]):"action_noe"==o.type?e("button",{staticClass:"btn btn-link"},[a._v(a._s(o.actionName+" N.O.E. = "+o.actionNOE+" "+o.deley+"s"))]):"chain_ec"==o.type?e("button",{staticClass:"btn btn-link"},[a._v(a._s((o.linkId?o.execChainName:a.findChain(o.execChainId).name)+" E.C. = "+o.chainEC+" "+o.deley+"s"))]):a._e()])})),0):e("div",[a._v("No bonds added.")]),e("span",{staticClass:"float-right text-gray"},[a._v("E.C.: "+a._s(t.countdown))])])])])])})),0):e("div",{staticClass:"empty centered"},[a._m(20),e("p",{staticClass:"empty-title h5"},[a._v("There are no chains configured")]),e("p",{staticClass:"empty-subtitle"},[a._v("Click the button to configure new")]),e("div",{staticClass:"empty-action"},[e("button",{staticClass:"btn btn-primary",on:{click:function(t){return a.openChainModal("Add new execution chain","",-1,1,!0)}}},[e("i",{staticClass:"icon icon-plus centered"})])])])])]),e("div",{staticClass:"panel-footer"},[e("span",{staticClass:"text-secondary"},[a._v("Last update: "+a._s(a.updateDate))]),e("div",{staticClass:"float-right tooltip tooltip-left",attrs:{"data-tooltip":"Auto refresh time (s)"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.autoRefreshTime,expression:"autoRefreshTime"}],staticClass:"form-input input-sm",attrs:{type:"number",id:"autorefresh"},domProps:{value:a.autoRefreshTime},on:{change:function(t){return a.autoRefresh()},input:function(t){t.target.composing||(a.autoRefreshTime=t.target.value)}}})])])])])},l=[function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"panel-title"},[e("h3",[a._v("Execution chains")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"name"}},[a._v("Name")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"countdown"}},[a._v("Execution countdown")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"type"}},[a._v("Type")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"deley"}},[a._v("Delay(s)")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label"},[a._v("Linked pi device")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"type"}},[a._v("Output target")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"type"}},[a._v("PWM target")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"type"}},[a._v("Action target")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"type"}},[a._v("RF transmit target")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"type"}},[a._v("Custom command target")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"type"}},[a._v("Chain target")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"type"}},[a._v("Set value of")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"type"}},[a._v("Action target")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"noe"}},[a._v("Number of executions")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"type"}},[a._v("Chain target")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"ec"}},[a._v("Execution countdown")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"state"}},[a._v("Set state")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"fr"}},[a._v("Set frequency(Hz)")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"dc"}},[a._v("Set dutycycle(%)")])])},function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"empty-icon"},[e("i",{staticClass:"icon icon-4x icon-cross"})])}],d={name:"Chains",data(){return{chains:[],refreshInterval:"",updateDate:"",autoRefreshTime:5,modalChainData:{active:!1,id:-1,title:"New execution chain",name:"",countdown:1,keepLogs:!0,errors:[]},modalBondData:{active:!1,id:-1,chainId:-1,title:"New chain bond",type:"",deley:1,bondLinked:!1,outputs:[],outputId:-1,pwms:[],pwmId:-1,pwmFr:600,pwmDc:0,state:0,actions:[],actionId:-1,actionNOE:-1,rfId:-1,rfCodes:[],cmdId:-1,cmds:[],linkId:0,linkedPis:[],exeChainId:-1,chainEC:1,chains:[],vars:[],varId:-1,varValue:"",selectedVarIndex:0,errors:[]},modalReorderData:{active:!1,chainId:-1,chainIndex:-1,bonds:[],errors:[]}}},props:{col:{type:String,default:"col-4 col-xl-6 col-sm-12"}},created(){this.getChains(),this.$cookies.isKey("chain_arTime")&&(this.autoRefreshTime=parseInt(this.$cookies.get("chain_arTime"))),this.autoRefresh()},beforeDestroy(){clearTimeout(this.refreshInterval)},methods:{autoRefresh(){this.$cookies.set("chain_arTime",this.autoRefreshTime,-1),clearTimeout(this.refreshInterval),this.autoRefreshTime>0&&(this.refreshInterval=setTimeout(()=>{this.modalChainData.active||this.modalBondData.active||this.modalReorderData.active||this.getChains(),this.autoRefresh()},1e3*this.autoRefreshTime))},compare(a,t){let e=0;return a.lp>t.lp?e=1:a.lp<t.lp&&(e=-1),e},openChainModal(a,t,e,o,s){this.modalChainData.active=!0,this.modalChainData.title=a,this.modalChainData.name=t,this.modalChainData.countdown=o,this.modalChainData.keepLogs=s,this.modalChainData.id=e,this.modalChainData.errors=[]},modalChainAction(a){if(this.modalChainData.errors=[],a||this.modalChainData.name||this.modalChainData.errors.push("Name required !"),!this.modalChainData.errors.length){let t="";t=a?"GPIO_ChainDelete;"+this.modalChainData.id:-1===this.modalChainData.id?"GPIO_ChainAdd;"+this.modalChainData.name+";"+this.modalChainData.countdown+";"+ +this.modalChainData.keepLogs:"GPIO_ChainUpdate;"+this.modalChainData.id+";"+this.modalChainData.name+";"+this.modalChainData.countdown+";"+ +this.modalChainData.keepLogs,this.doPost(t).then(()=>{this.getChains(),this.modalChainData.active=!1}).catch(a=>{this.modalChainData.errors.push(a.message)})}},openBondModal(a,t,e,o,s,n,i,l,d,r,c,m,u,h,p,v,f,D,C){this.modalBondData.active=!0,this.modalBondData.title=a,this.modalBondData.id=t,this.modalBondData.chainId=e,this.modalBondData.type=o,this.modalBondData.deley=s,this.modalBondData.outputId=n,this.modalBondData.pwmId=i,this.modalBondData.pwmFr=l,this.modalBondData.pwmDc=d,this.modalBondData.state=r,this.modalBondData.actionId=c,this.modalBondData.rfId=m,this.modalBondData.cmdId=u,this.modalBondData.linkId=h,this.modalBondData.exeChainId=p,this.modalBondData.linkedPis=[],this.modalBondData.vars=[],this.modalBondData.varId=v,this.modalBondData.varValue=f,this.modalBondData.actionNOE=D,this.modalBondData.chainEC=C,this.modalBondData.errors=[],this.modalBondData.bondLinked=!!h,this.reFetchTargetsData(e).then(()=>{v&&(this.modalBondData.selectedVarIndex=this.modalBondData.vars.findIndex(a=>a.id==v))}),this.doPost("GetLinkedPis;0").then(a=>{for(var t=2;t<a.length-1;t+=6)this.modalBondData.linkedPis.push({id:a[t],name:a[t+1]})}).catch(a=>{this.modalBondData.errors.push(a.message)})},modalBondAction(a){if(this.modalBondData.errors=[],a||(this.modalBondData.deley||this.modalBondData.errors.push("Deley is required !"),"output"!=this.modalBondData.type||this.modalBondData.outputId?"pwm"!=this.modalBondData.type||this.modalBondData.pwmId?"action"!=this.modalBondData.type&&"action_noe"!=this.modalBondData.type||this.modalBondData.actionId?"rfsend"!=this.modalBondData.type||this.modalBondData.rfId?"cmd"!=this.modalBondData.type||this.modalBondData.cmdId?"chain"!=this.modalBondData.type&&"chain_ec"!=this.modalBondData.type||this.modalBondData.exeChainId?"var"!=this.modalBondData.type||this.modalBondData.varId||this.modalBondData.errors.push("Variable target id is required !"):this.modalBondData.errors.push("Chain target id is required !"):this.modalBondData.errors.push("Custom command target id is required !"):this.modalBondData.errors.push("Rf transmit target id is required !"):this.modalBondData.errors.push("Action id is required !"):this.modalBondData.errors.push("Pwm id is required !"):this.modalBondData.errors.push("Output id is required !")),!this.modalBondData.errors.length){let t="",e=null,o=null,s="";"output"==this.modalBondData.type?(e=this.modalBondData.outputId,o=this.modalBondData.state,s=this.modalBondData.outputs.find(a=>a.id==e).name):"pwm"==this.modalBondData.type?(e=this.modalBondData.pwmId,o=this.modalBondData.state,s=this.modalBondData.pwms.find(a=>a.id==e).name):"action"==this.modalBondData.type?(e=this.modalBondData.actionId,o=this.modalBondData.state,s=this.modalBondData.actions.find(a=>a.id==e).name):"rfsend"==this.modalBondData.type?(e=this.modalBondData.rfId,o=this.modalBondData.state,s=this.modalBondData.rfCodes.find(a=>a.id==e).name):"cmd"==this.modalBondData.type?(e=this.modalBondData.cmdId,o=this.modalBondData.state,s=this.modalBondData.cmds.find(a=>a.id==e).name):"chain"==this.modalBondData.type?(e=this.modalBondData.exeChainId,o=this.modalBondData.state,s=this.modalBondData.chains.find(a=>a.id==e).name):"var"==this.modalBondData.type?(e=this.modalBondData.varId,o=this.modalBondData.varValue,s=this.modalBondData.vars.find(a=>a.id==e).name):"action_noe"==this.modalBondData.type?(e=this.modalBondData.actionId,o=this.modalBondData.actionNOE,s=this.modalBondData.actions.find(a=>a.id==e).name):"chain_ec"==this.modalBondData.type&&(e=this.modalBondData.exeChainId,o=this.modalBondData.chainEC,s=this.modalBondData.chains.find(a=>a.id==e).name),t=a?"GPIO_ChainBondDelete;"+this.modalBondData.id+";"+this.modalBondData.chainId:-1===this.modalBondData.id?"GPIO_ChainBondAdd;"+this.modalBondData.chainId+";"+this.modalBondData.type+";"+this.modalBondData.deley+";"+e+";"+o+";"+this.modalBondData.pwmFr+";"+this.modalBondData.pwmDc+";"+this.modalBondData.linkId+";"+s:"GPIO_ChainBondUpdate;"+this.modalBondData.chainId+";"+this.modalBondData.type+";"+this.modalBondData.deley+";"+e+";"+o+";"+this.modalBondData.pwmFr+";"+this.modalBondData.pwmDc+";"+this.modalBondData.id+";"+this.modalBondData.linkId+";"+s,this.doPost(t).then(()=>{this.getChains(),this.modalBondData.active=!1}).catch(a=>{this.modalBondData.errors.push(a.message)})}},openReorderModal(a,t,e){this.modalReorderData.active=!0,this.modalReorderData.chainId=a,this.modalReorderData.chainIndex=t,this.modalReorderData.bonds=e},reorder(a,t){let e=this.modalReorderData.bonds[t];a?(this.modalReorderData.bonds[t]=this.modalReorderData.bonds[t-1],this.modalReorderData.bonds[t].lp++,e.lp--,this.modalReorderData.bonds[t-1]=e):(this.modalReorderData.bonds[t]=this.modalReorderData.bonds[t+1],this.modalReorderData.bonds[t].lp--,e.lp++,this.modalReorderData.bonds[t+1]=e)},findChain(a){return this.chains.find(t=>t.id==a)},modalReorderAction(){let a="";for(let t=0;t<this.modalReorderData.bonds.length;t++)a+=this.modalReorderData.bonds[t].lp+"$"+this.modalReorderData.bonds[t].id,t<this.modalReorderData.bonds.length-1&&(a+="$");this.doPost("GPIO_ChainBondsOrder;"+this.modalReorderData.chainId+";"+a).then(()=>{this.chains[this.modalReorderData.chainIndex].bonds=this.modalReorderData.bonds,this.modalReorderData.active=!1}).catch(a=>{this.modalReorderData.errors.push(a.message)})},getChains(){this.doPost("GPIO_ChainList").then(a=>{this.$route.meta.error=null,this.chains=[];for(var t=2;t<a.length-1;t+=7){let o=a[t+6].split("$"),s=[];for(var e=0;e<o.length-1;e+=28){let a=Boolean(parseInt(o[e+19])),t=o[e+21]+":"+o[e+20];s.push({id:parseInt(o[e]),chainId:parseInt(o[e+1]),lp:parseInt(o[e+2]),deley:parseFloat(o[e+3]),type:o[e+4],actionId:parseInt(o[e+5]),outputId:parseInt(o[e+6]),outputState:parseInt(o[e+7]),pwmId:parseInt(o[e+8]),pwmFr:parseInt(o[e+9]),pwmDc:parseInt(o[e+10]),pwmSs:parseInt(o[e+11]),outputName:a?t:o[e+12],pwmName:a?t:o[e+13],actionName:a?t:o[e+14],rfId:parseInt(o[e+15]),rfName:a?t:o[e+16],cmdId:parseInt(o[e+17]),cmdName:a?t:o[e+18],linkId:parseInt(o[e+19]),linkName:o[e+20],linkedDeviceName:o[e+21],execChainId:parseInt(o[e+22]),execChainName:t,varId:parseInt(o[e+23]),varValue:o[e+24],varName:a?t:o[e+25],actionNOE:o[e+26],chainEC:o[e+27]})}s=s.sort(this.compare),this.chains.push({id:parseInt(a[t]),status:parseInt(a[t+1]),name:a[t+2],countdown:parseInt(a[t+4]),keepLogs:!!+a[t+5],bonds:s})}this.updateDate=this.$moment().format("YYYY-MM-DD HH:mm:ss.SSS")}).catch(a=>{this.$route.meta.error=a.message,this.$forceUpdate()})},execudeOrCancel(a){let t="";t=this.chains[a].status?"GPIO_ChainCancel;"+this.chains[a].id:"GPIO_ChainExecute;"+this.chains[a].id+";"+ +this.chains[a].keepLogs,this.doPost(t).then(t=>{this.$route.meta.error=null,"GPIO_ChainExecute"==t[1]?this.chains[a].status=1:"GPIO_ChainCancel"==t[1]&&(this.chains[a].status=0)}).catch(a=>{this.$route.meta.error=a.message,this.$forceUpdate()})},reFetchTargetsData(){this.modalBondData.rfCodes=[],this.modalBondData.actions=[],this.modalBondData.pwms=[],this.modalBondData.cmds=[],this.modalBondData.errors=[],this.modalBondData.outputs=[],this.modalBondData.chains=[],this.modalBondData.vars=[];let a="";if(this.modalBondData.linkId&&this.modalBondData.bondLinked&&(a="CallLinkedPi;"+this.modalBondData.linkId+";"),!this.modalBondData.bondLinked||this.modalBondData.linkId)return this.doPosts([this.doQPost(a+"GPIO_Oname").then(a=>{for(var t=2;t<a.length-1;t+=4)this.modalBondData.outputs.push({id:a[t],name:a[t+1]})}),this.doQPost(a+"GPIO_PWMnames").then(a=>{for(var t=2;t<a.length-1;t+=2)this.modalBondData.pwms.push({id:a[t],name:a[t+1]})}),this.doQPost(a+"GPIO_ActionsNames").then(a=>{for(var t=2;t<a.length-1;t+=2)this.modalBondData.actions.push({id:a[t],name:a[t+1]})}),this.doQPost(a+"GetRfCodes").then(a=>{for(var t=2;t<a.length-1;t+=8)"Transmit"==a[t+2]&&this.modalBondData.rfCodes.push({id:a[t],name:a[t+1]})}),this.doQPost(a+"GetCustomCmds").then(a=>{for(var t=2;t<a.length-1;t+=4)this.modalBondData.cmds.push({id:a[t],name:a[t+1]})}),this.doQPost(a+"Chain_names").then(a=>{for(var t=2;t<a.length-1;t+=2)this.modalBondData.chains.push({id:a[t],name:a[t+1]})}),this.doQPost(a+"GetGlobalVars").then(a=>{for(var t=2;t<a.length-1;t+=5)this.modalBondData.vars.push({id:a[t],name:a[t+1],type:a[t+3]})})]).catch(a=>{this.modalBondData.errors.push(a.message)})}},components:{Error:n["a"]}},r=d,c=e("2877"),m=Object(c["a"])(r,i,l,!1,null,null,null),u=m.exports,h=e("49a3"),p={name:"Chains",components:{Error:n["a"],Chain:u,History:h["a"]}},v=p,f=Object(c["a"])(v,o,s,!1,null,null,null);t["default"]=f.exports}}]);