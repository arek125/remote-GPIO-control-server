(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Pwms"],{"1e35":function(t,e,a){},"3fb9":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"toast toast-error"},[a("button",{staticClass:"btn btn-clear float-right",on:{click:function(e){return t.$emit("close-err")}}}),""!==t.errorMessage&&null!==t.errorMessage?a("span",[t._v(" "+t._s(t.errorMessage)+" ")]):t._e(),t.errorArray.length&&null!==t.errorArray?a("ul",t._l(t.errorArray,(function(e,s){return a("li",{key:s},[t._v(t._s(e))])})),0):t._e()])},r=[],i={name:"Error",props:{errorMessage:{type:String,required:!1},errorArray:{default:()=>[],type:Array,required:!1}}},o=i,l=a("2877"),n=Object(l["a"])(o,s,r,!1,null,null,null);e["a"]=n.exports},"49a3":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"panel"},[a("div",{staticClass:"panel-header"},[t._m(0),null!==t.$route.meta.error?a("Error",{attrs:{"error-message":t.$route.meta.error},on:{"close-err":function(e){t.$route.meta.error=null,t.$forceUpdate()}}}):t._e()],1),a("div",{staticClass:"panel-nav"},[a("div",{staticClass:"input-group filter"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.dateFrom,expression:"dateFrom"}],staticClass:"form-input input-sm",attrs:{type:"date",placeholder:"Date from"},domProps:{value:t.dateFrom},on:{input:function(e){e.target.composing||(t.dateFrom=e.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.dateTo,expression:"dateTo"}],staticClass:"form-input input-sm",attrs:{type:"date",placeholder:"Date to"},domProps:{value:t.dateTo},on:{input:function(e){e.target.composing||(t.dateTo=e.target.value)}}}),a("button",{staticClass:"btn input-group-btn btn-sm",on:{click:function(e){return t.getHistory()}}},[a("i",{staticClass:"icon icon-refresh centered"})])])]),a("div",{staticClass:"panel-body"},[t.history.length?a("table",{staticClass:"table table-striped"},[t._m(1),a("tbody",t._l(t.history,(function(e){return a("tr",{key:e.id},[a("td",[t._v(t._s(e.date))]),a("td",[t._v(t._s(e.name))]),a("td",[t._v(t._s(e.state))]),a("td",[t._v(t._s(e.by))])])})),0)]):a("div",{staticClass:"empty centered"},[t._m(2),a("p",{staticClass:"empty-title h5"},[t._v("There are is no data in the selected range")])])]),a("div",{staticClass:"panel-footer"},[a("span",{staticClass:"text-secondary"},[t._v("Last update: "+t._s(t.updateDate))]),a("div",{staticClass:"float-right tooltip tooltip-left",attrs:{"data-tooltip":"Auto refresh time (s)"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.autoRefreshTime,expression:"autoRefreshTime"}],staticClass:"form-input input-sm",attrs:{type:"number",id:"autorefresh"},domProps:{value:t.autoRefreshTime},on:{change:function(e){return t.autoRefresh()},input:function(e){e.target.composing||(t.autoRefreshTime=e.target.value)}}})])])])])},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"panel-title"},[a("h3",[t._v("History")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",[t._v("Date")]),a("th",[t._v("Name")]),a("th",[t._v("Action")]),a("th",[t._v("By")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"empty-icon"},[a("i",{staticClass:"icon icon-4x icon-cross"})])}],i=a("3fb9"),o={name:"History",data(){return{history:[],refreshInterval:"",updateDate:"",autoRefreshTime:5,dateFrom:"",dateTo:""}},props:["category"],created(){this.dateFrom=this.$moment().subtract(7,"days").format("YYYY-MM-DD"),this.dateTo=this.$moment().add(1,"days").format("YYYY-MM-DD"),this.getHistory(),this.$cookies.isKey("hr_arTime")&&(this.autoRefreshTime=parseInt(this.$cookies.get("hr_arTime"))),this.autoRefresh()},beforeDestroy(){clearTimeout(this.refreshInterval)},methods:{autoRefresh(){this.$cookies.set("hr_arTime",this.autoRefreshTime,-1),clearTimeout(this.refreshInterval),this.autoRefreshTime>0&&(this.refreshInterval=setTimeout(()=>{this.getHistory(),this.autoRefresh()},1e3*this.autoRefreshTime))},getHistory(){this.dateFrom&&this.dateTo&&this.doPost("HR_selByCat;"+this.$moment(this.dateFrom,"YYYY-MM-DD").utc().format("YYYY-MM-DD")+";"+this.$moment(this.dateTo+" 23:59:59","YYYY-MM-DD HH:mm:ss").utc().format("YYYY-MM-DD")+";"+this.category).then(t=>{this.$route.meta.error=null,this.history=[];for(var e=2;e<t.length-1;e+=5)this.history.push({id:parseInt(t[e]),date:this.$moment.utc(t[e+1],"YYYY-MM-DD HH:mm:ss").local().format("YYYY-MM-DD HH:mm:ss"),by:t[e+2],name:t[e+3],state:t[e+4]});this.updateDate=this.$moment().format("YYYY-MM-DD HH:mm:ss.SSS")}).catch(t=>{this.$route.meta.error=t.message,this.$forceUpdate()})}},components:{Error:i["a"]}},l=o,n=a("2877"),m=Object(n["a"])(l,s,r,!1,null,null,null);e["a"]=m.exports},"64be":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"PWM's"},[null!==t.$route.meta.error?a("Error",{attrs:{"error-message":t.$route.meta.error},on:{"close-err":function(e){t.$route.meta.error=null,t.$forceUpdate()}}}):a("div",{staticClass:"container"},[a("div",{staticClass:"columns"},[a("GPIO_Pwm",{staticClass:"column col-8 col-md-12",attrs:{col:"col-4 col-xl-6 col-md-12"}}),a("History",{staticClass:"column col-4 col-md-12",attrs:{category:"pwm"}})],1)])],1)},r=[],i=a("3fb9"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"panel"},[a("div",{staticClass:"panel-header"},[t._m(0),null!==t.$route.meta.error?a("Error",{attrs:{"error-message":t.$route.meta.error},on:{"close-err":function(e){t.$route.meta.error=null,t.$forceUpdate()}}}):t._e()],1),a("div",{staticClass:"panel-nav"},[a("div",{staticClass:"btn-group btn-group-block float-right"},[a("button",{staticClass:"btn",on:{click:function(e){return t.getPwms()}}},[a("i",{staticClass:"icon icon-refresh centered"})]),a("button",{staticClass:"btn",on:{click:function(e){return t.openModal("Add new pwm","","",!1,"","",-1)}}},[a("i",{staticClass:"icon icon-plus centered"})])])]),a("div",{staticClass:"panel-body"},[a("div",{staticClass:"modal",class:{active:t.modalData.active}},[a("a",{staticClass:"modal-overlay",attrs:{"aria-label":"Close"},on:{click:function(e){t.modalData.active=!1}}}),a("div",{staticClass:"modal-container"},[a("div",{staticClass:"modal-header"},[a("a",{staticClass:"btn btn-clear float-right",attrs:{"aria-label":"Close"},on:{click:function(e){t.modalData.active=!1}}}),a("div",{staticClass:"modal-title h5"},[t._v(t._s(t.modalData.title))]),t.modalData.errors.length?a("Error",{attrs:{"error-array":t.modalData.errors},on:{"close-err":function(e){t.modalData.errors=[]}}}):t._e()],1),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"content"},[a("form",{staticClass:"form-horizontal"},[a("div",{staticClass:"form-group"},[t._m(1),a("div",{staticClass:"col-9 col-sm-12"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.modalData.name,expression:"modalData.name"}],staticClass:"form-input",attrs:{type:"text",id:"name",placeholder:"Name"},domProps:{value:t.modalData.name},on:{input:function(e){e.target.composing||t.$set(t.modalData,"name",e.target.value)}}})])]),a("div",{staticClass:"form-group"},[t._m(2),a("div",{staticClass:"col-9 col-sm-12"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.modalData.gpio,expression:"modalData.gpio"}],staticClass:"form-input",attrs:{type:"text",id:"gpio",placeholder:"Comma separated GPIO BCM numbers"},domProps:{value:t.modalData.gpio},on:{input:function(e){e.target.composing||t.$set(t.modalData,"gpio",e.target.value)}}})])]),a("div",{staticClass:"form-group"},[a("label",{staticClass:"form-switch"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.modalData.reverse,expression:"modalData.reverse"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.modalData.reverse)?t._i(t.modalData.reverse,null)>-1:t.modalData.reverse},on:{change:function(e){var a=t.modalData.reverse,s=e.target,r=!!s.checked;if(Array.isArray(a)){var i=null,o=t._i(a,i);s.checked?o<0&&t.$set(t.modalData,"reverse",a.concat([i])):o>-1&&t.$set(t.modalData,"reverse",a.slice(0,o).concat(a.slice(o+1)))}else t.$set(t.modalData,"reverse",r)}}}),a("i",{staticClass:"form-icon"}),t._v("Reverse ")])]),a("div",{staticClass:"form-group"},[t._m(3),a("div",{staticClass:"col-9 col-sm-12"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.modalData.fr,expression:"modalData.fr"}],staticClass:"form-input",attrs:{type:"number",id:"fr"},domProps:{value:t.modalData.fr},on:{input:function(e){e.target.composing||t.$set(t.modalData,"fr",e.target.value)}}})])]),a("div",{staticClass:"form-group"},[t._m(4),a("div",{staticClass:"col-9 col-sm-12"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.modalData.dc,expression:"modalData.dc"}],staticClass:"form-input",attrs:{type:"number",id:"dc",min:"0",max:"100"},domProps:{value:t.modalData.dc},on:{input:function(e){e.target.composing||t.$set(t.modalData,"dc",e.target.value)}}})])])])])]),a("div",{staticClass:"modal-footer"},[a("button",{directives:[{name:"show",rawName:"v-show",value:-1!==t.modalData.id,expression:"modalData.id !== -1"}],staticClass:"btn btn-code float-left",attrs:{disabled:this.loading},on:{click:function(e){return t.modalAction(!0)}}},[a("i",{staticClass:"icon icon-delete"}),t._v(" Delete")]),a("button",{staticClass:"btn btn-primary",attrs:{disabled:this.loading},on:{click:function(e){return t.modalAction(!1)}}},[a("i",{staticClass:"icon icon-check"}),t._v(" Confirm")])])])]),a("div",{staticClass:"container"},[t.pwms.length||t.loading?a("div",{staticClass:"columns"},t._l(t.pwms,(function(e,s){return a("div",{key:e.id,staticClass:"column",class:[t.col]},[a("div",{staticClass:"tile"},[a("div",{staticClass:"tile-icon d-grid"},[a("button",{staticClass:"btn btn-action btn-lg",class:[t.stateButton(e.s_s,0)],on:{click:function(e){return t.setSS(s)}}},[a("i",{staticClass:"icon icon-shutdown centered"})]),a("button",{staticClass:"btn btn-link float-right",on:{click:function(a){return t.openModal("Edit "+e.name,e.name,e.gpio,!!e.reverse,e.fr,e.dc,e.id)}}},[a("i",{staticClass:"icon icon-edit"})])]),a("div",{staticClass:"tile-content"},[a("div",{staticClass:"tile-title"},[a("span",[t._v(t._s(e.name))]),a("div",{staticClass:"float-right tooltip tooltip-left low-width",attrs:{"data-tooltip":"Frequency (Hz)"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.fr,expression:"pwm.fr"}],staticClass:"form-input input-sm",attrs:{type:"number",disabled:!e.s_s},domProps:{value:e.fr},on:{change:function(e){return t.setDCFR(s)},input:function(a){a.target.composing||t.$set(e,"fr",a.target.value)}}})])]),a("div",{staticClass:"tile-subtitle text-gray"},[a("span",[t._v("GPIO:"+t._s(e.gpio))]),a("div",{staticClass:"float-right tooltip tooltip-left low-width",attrs:{"data-tooltip":"Dutycycle (%)"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.dc,expression:"pwm.dc"}],staticClass:"form-input input-sm",attrs:{type:"number",min:"0",max:"100",disabled:!e.s_s},domProps:{value:e.dc},on:{change:function(e){return t.setDCFR(s)},input:function(a){a.target.composing||t.$set(e,"dc",a.target.value)}}})])]),a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.dc,expression:"pwm.dc"}],staticClass:"slider",class:{reverse:!!e.reverse},attrs:{type:"range",min:"0",max:"100",disabled:!e.s_s},domProps:{value:e.dc},on:{change:function(e){return t.setDCFR(s)},__r:function(a){return t.$set(e,"dc",a.target.value)}}})])])])])})),0):a("div",{staticClass:"empty centered"},[t._m(5),a("p",{staticClass:"empty-title h5"},[t._v("There are no pwm's configured")]),a("p",{staticClass:"empty-subtitle"},[t._v("Click the button to configure new")]),a("div",{staticClass:"empty-action"},[a("button",{staticClass:"btn btn-primary",on:{click:function(e){return t.openModal("Add new pwm","","",!1,"","",-1)}}},[a("i",{staticClass:"icon icon-plus centered"})])])])])]),a("div",{staticClass:"panel-footer"},[a("span",{staticClass:"text-secondary"},[t._v("Last update: "+t._s(t.updateDate))]),a("div",{staticClass:"float-right tooltip tooltip-left",attrs:{"data-tooltip":"Auto refresh time (s)"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.autoRefreshTime,expression:"autoRefreshTime"}],staticClass:"form-input input-sm low-width",attrs:{type:"number",id:"autorefresh"},domProps:{value:t.autoRefreshTime},on:{change:function(e){return t.autoRefresh()},input:function(e){e.target.composing||(t.autoRefreshTime=e.target.value)}}})])])])])},l=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"panel-title"},[a("h3",[t._v("GPIO Pwms")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-3 col-sm-12"},[a("label",{staticClass:"form-label",attrs:{for:"name"}},[t._v("Name")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-3 col-sm-12"},[a("label",{staticClass:"form-label",attrs:{for:"gpio"}},[t._v("GPIO(BCM)")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-3 col-sm-12"},[a("label",{staticClass:"form-label",attrs:{for:"fr"}},[t._v("Frequency(Hz)")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-3 col-sm-12"},[a("label",{staticClass:"form-label",attrs:{for:"dc"}},[t._v("Dutycycle(%)")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"empty-icon"},[a("i",{staticClass:"icon icon-4x icon-cross"})])}],n={name:"GPIO_Pwm",data(){return{pwms:[],refreshInterval:"",updateDate:"",changeDate:null,askedChangeDate:null,autoRefreshTime:15,modalData:{active:!1,id:-1,title:"New pwm",name:"",gpio:"",prevsGpios:"",reverse:!1,fr:"",dc:"",errors:[],allUsedPins:[]}}},props:{col:{type:String,default:"col-4 col-lg-6 col-sm-12"}},created(){this.getPwms(),this.$cookies.isKey("pwm_arTime")&&(this.autoRefreshTime=parseInt(this.$cookies.get("pwm_arTime"))),this.autoRefresh()},beforeDestroy(){clearTimeout(this.refreshInterval)},methods:{autoRefresh(){this.$cookies.set("pwm_arTime",this.autoRefreshTime,-1),clearTimeout(this.refreshInterval),this.autoRefreshTime>0&&(this.refreshInterval=setTimeout(()=>{this.modalData.active||this.checkForChanges(),this.autoRefresh()},1e3*this.autoRefreshTime))},openModal(t,e,a,s,r,i,o){this.modalData.active=!0,this.modalData.title=t,this.modalData.name=e,this.modalData.gpio=a,this.modalData.prevsGpios=a,this.modalData.reverse=s,this.modalData.id=o,this.modalData.fr=r,this.modalData.dc=i,this.modalData.allUsedPins=[],this.modalData.errors=[],this.doPost("AllUsedPins_GPIO;pwm;"+o).then(t=>{for(var e=2;e<t.length-1;e++)this.modalData.allUsedPins.push(t[e])}).catch(t=>{this.modalData.errors.push(t.message)})},modalAction(t){if(this.modalData.errors=[],!t){if(this.modalData.name||this.modalData.errors.push("Name required !"),/^[0-9]+(,[0-9]+)*$/g.test(this.modalData.gpio)){let t=this.modalData.gpio.split(",");var e=this.isGPIOnumber(t);if(-1!=e)this.modalData.errors.push(e+" is not a GPIO BCM number !");else for(let e=0;e<t.length;e++)this.modalData.allUsedPins.indexOf(t[e])>-1&&this.modalData.errors.push(t[e]+" allready in use !")}else this.modalData.errors.push("GPIO must be a number or comma separated numbers !");this.modalData.fr&&this.modalData.dc||this.modalData.errors.push("Initial frequency and dutycycle are required !")}if(!this.modalData.errors.length){let e="";e=t?"Delete_GPIO_pwm;"+this.modalData.id+";"+this.modalData.gpio+";"+this.modalData.name:-1===this.modalData.id?"Add_GPIO_pwm;"+this.modalData.gpio+";"+this.modalData.fr+";"+this.modalData.dc+";"+this.modalData.name+";"+ +this.modalData.reverse+";"+this.$moment.utc().format("YYYY-MM-DD HH:mm:ss.SSS"):"Edit_GPIO_pwm;"+this.modalData.id+";"+this.modalData.prevsGpios+";"+this.modalData.gpio+";"+this.modalData.fr+";"+this.modalData.dc+";"+this.modalData.name+";"+ +this.modalData.reverse+";"+this.$moment.utc().format("YYYY-MM-DD HH:mm:ss.SSS"),this.doPost(e).then(()=>{this.getPwms(),this.modalData.active=!1}).catch(t=>{this.modalData.errors.push(t.message)})}},getPwms(){this.doPost("GPIO_Plist").then(t=>{this.$route.meta.error=null,this.pwms=[];for(var e=2;e<t.length-1;e+=7)this.pwms.push({id:parseInt(t[e]),gpio:t[e+1],fr:parseInt(t[e+2]),dc:parseInt(t[e+3]),prevFr:parseInt(t[e+2]),prevDc:parseInt(t[e+3]),s_s:parseInt(t[e+4]),name:t[e+5],reverse:parseInt(t[e+6])});this.changeDate=this.$moment.utc().toDate()}).catch(t=>{this.$route.meta.error=t.message,this.$forceUpdate()})},checkForChanges(){this.loading||this.doPost("GPIO_PEtime").then(t=>{this.$route.meta.error=null,"None"!==t[2]&&(this.askedChangeDate=this.$moment.utc(t[2],"YYYY-MM-DD HH:mm:ss.SSS").toDate(),this.changeDate<this.askedChangeDate&&this.getPwms()),this.updateDate=this.$moment().format("YYYY-MM-DD HH:mm:ss.SSS")}).catch(t=>{this.$route.meta.error=t.message,this.$forceUpdate()})},setDCFR(t){this.doPost("GPIO_PFRDC;"+this.pwms[t].id+";"+this.pwms[t].gpio+";"+this.pwms[t].fr+";"+this.pwms[t].dc+";"+this.$moment.utc().format("YYYY-MM-DD HH:mm:ss.SSS")+";"+this.pwms[t].s_s+";1").then(()=>{this.$route.meta.error=null,this.changeDate=this.$moment.utc().toDate(),this.pwms[t].prevFr=this.pwms[t].fr,this.pwms[t].prevDc=this.pwms[t].dc}).catch(e=>{this.pwms[t].fr=this.pwms[t].prevFr,this.pwms[t].dc=this.pwms[t].prevDc,this.$route.meta.error=e.message,this.$forceUpdate()})},setSS(t){this.doPost("GPIO_PSS;"+this.pwms[t].id+";"+this.pwms[t].gpio+";"+this.pwms[t].dc+";"+this.$moment.utc().format("YYYY-MM-DD HH:mm:ss.SSS")+";"+ +!this.pwms[t].s_s+";"+this.pwms[t].fr).then(e=>{this.$route.meta.error=null,this.changeDate=this.$moment.utc().toDate(),this.pwms[t].s_s=parseInt(e[4])}).catch(t=>{this.$route.meta.error=t.message,this.$forceUpdate()})}},components:{Error:i["a"]}},m=n,c=(a("fd84"),a("2877")),d=Object(c["a"])(m,o,l,!1,null,null,null),u=d.exports,h=a("49a3"),p={name:"PWMs",components:{Error:i["a"],GPIO_Pwm:u,History:h["a"]}},f=p,v=Object(c["a"])(f,s,r,!1,null,null,null);e["default"]=v.exports},fd84:function(t,e,a){"use strict";a("1e35")}}]);