(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["CustomCmds"],{"3fb9":function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"toast toast-error"},[e("button",{staticClass:"btn btn-clear float-right",on:{click:function(a){return t.$emit("close-err")}}}),""!==t.errorMessage&&null!==t.errorMessage?e("span",[t._v(" "+t._s(t.errorMessage)+" ")]):t._e(),t.errorArray.length&&null!==t.errorArray?e("ul",t._l(t.errorArray,(function(a,s){return e("li",{key:s},[t._v(t._s(a))])})),0):t._e()])},i=[],o={name:"Error",props:{errorMessage:{type:String,required:!1},errorArray:{default:()=>[],type:Array,required:!1}}},r=o,l=e("2877"),n=Object(l["a"])(r,s,i,!1,null,null,null);a["a"]=n.exports},"49a3":function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"panel"},[e("div",{staticClass:"panel-header"},[t._m(0),null!==t.$route.meta.error?e("Error",{attrs:{"error-message":t.$route.meta.error},on:{"close-err":function(a){t.$route.meta.error=null,t.$forceUpdate()}}}):t._e()],1),e("div",{staticClass:"panel-nav"},[e("div",{staticClass:"input-group filter"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.dateFrom,expression:"dateFrom"}],staticClass:"form-input input-sm",attrs:{type:"date",placeholder:"Date from"},domProps:{value:t.dateFrom},on:{input:function(a){a.target.composing||(t.dateFrom=a.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.dateTo,expression:"dateTo"}],staticClass:"form-input input-sm",attrs:{type:"date",placeholder:"Date to"},domProps:{value:t.dateTo},on:{input:function(a){a.target.composing||(t.dateTo=a.target.value)}}}),e("button",{staticClass:"btn input-group-btn btn-sm",on:{click:function(a){return t.getHistory()}}},[e("i",{staticClass:"icon icon-refresh centered"})])])]),e("div",{staticClass:"panel-body"},[t.history.length?e("table",{staticClass:"table table-striped"},[t._m(1),e("tbody",t._l(t.history,(function(a){return e("tr",{key:a.id},[e("td",[t._v(t._s(a.date))]),e("td",[t._v(t._s(a.name))]),e("td",[t._v(t._s(a.state))]),e("td",[t._v(t._s(a.by))])])})),0)]):e("div",{staticClass:"empty centered"},[t._m(2),e("p",{staticClass:"empty-title h5"},[t._v("There are is no data in the selected range")])])]),e("div",{staticClass:"panel-footer"},[e("span",{staticClass:"text-secondary"},[t._v("Last update: "+t._s(t.updateDate))]),e("div",{staticClass:"float-right tooltip tooltip-left",attrs:{"data-tooltip":"Auto refresh time (s)"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.autoRefreshTime,expression:"autoRefreshTime"}],staticClass:"form-input input-sm",attrs:{type:"number",id:"autorefresh"},domProps:{value:t.autoRefreshTime},on:{change:function(a){return t.autoRefresh()},input:function(a){a.target.composing||(t.autoRefreshTime=a.target.value)}}})])])])])},i=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"panel-title"},[e("h3",[t._v("History")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",[t._v("Date")]),e("th",[t._v("Name")]),e("th",[t._v("Action")]),e("th",[t._v("By")])])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"empty-icon"},[e("i",{staticClass:"icon icon-4x icon-cross"})])}],o=e("3fb9"),r={name:"History",data(){return{history:[],refreshInterval:"",updateDate:"",autoRefreshTime:5,dateFrom:"",dateTo:""}},props:["category"],created(){this.dateFrom=this.$moment().subtract(7,"days").format("YYYY-MM-DD"),this.dateTo=this.$moment().add(1,"days").format("YYYY-MM-DD"),this.getHistory(),this.$cookies.isKey("hr_arTime")&&(this.autoRefreshTime=parseInt(this.$cookies.get("hr_arTime"))),this.autoRefresh()},beforeDestroy(){clearTimeout(this.refreshInterval)},methods:{autoRefresh(){this.$cookies.set("hr_arTime",this.autoRefreshTime,-1),clearTimeout(this.refreshInterval),this.autoRefreshTime>0&&(this.refreshInterval=setTimeout(()=>{this.getHistory(),this.autoRefresh()},1e3*this.autoRefreshTime))},getHistory(){this.dateFrom&&this.dateTo&&this.doPost("HR_selByCat;"+this.$moment(this.dateFrom,"YYYY-MM-DD").utc().format("YYYY-MM-DD")+";"+this.$moment(this.dateTo+" 23:59:59","YYYY-MM-DD HH:mm:ss").utc().format("YYYY-MM-DD")+";"+this.category).then(t=>{this.$route.meta.error=null,this.history=[];for(var a=2;a<t.length-1;a+=5)this.history.push({id:parseInt(t[a]),date:this.$moment.utc(t[a+1],"YYYY-MM-DD HH:mm:ss").local().format("YYYY-MM-DD HH:mm:ss"),by:t[a+2],name:t[a+3],state:t[a+4]});this.updateDate=this.$moment().format("YYYY-MM-DD HH:mm:ss.SSS")}).catch(t=>{this.$route.meta.error=t.message,this.$forceUpdate()})}},components:{Error:o["a"]}},l=r,n=e("2877"),c=Object(n["a"])(l,s,i,!1,null,null,null);a["a"]=c.exports},"61b1":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"customcmds"},[null!==t.$route.meta.error?e("Error",{attrs:{"error-message":t.$route.meta.error},on:{"close-err":function(a){t.$route.meta.error=null,t.$forceUpdate()}}}):e("div",{staticClass:"container"},[e("div",{staticClass:"columns"},[e("CustomCmds",{staticClass:"column col-8 col-md-12"}),e("History",{staticClass:"column col-4 col-md-12",attrs:{category:"cmd"}})],1)])],1)},i=[],o=e("3fb9"),r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"panel"},[e("div",{staticClass:"panel-header"},[t._m(0),null!==t.$route.meta.error?e("Error",{attrs:{"error-message":t.$route.meta.error},on:{"close-err":function(a){t.$route.meta.error=null,t.$forceUpdate()}}}):t._e()],1),e("div",{staticClass:"panel-nav"},[e("div",{staticClass:"btn-group btn-group-block float-right"},[e("button",{staticClass:"btn",on:{click:function(a){return t.getCmds()}}},[e("i",{staticClass:"icon icon-refresh centered"})]),e("button",{staticClass:"btn",on:{click:function(a){return t.openModal("Add new cmd",-1,"","",!1)}}},[e("i",{staticClass:"icon icon-plus centered"})])])]),e("div",{staticClass:"panel-body"},[e("div",{staticClass:"modal",class:{active:t.modalData.active}},[e("a",{staticClass:"modal-overlay",attrs:{"aria-label":"Close"},on:{click:function(a){t.modalData.active=!1}}}),e("div",{staticClass:"modal-container"},[e("div",{staticClass:"modal-header"},[e("a",{staticClass:"btn btn-clear float-right",attrs:{"aria-label":"Close"},on:{click:function(a){t.modalData.active=!1}}}),e("div",{staticClass:"modal-title h5"},[t._v(t._s(t.modalData.title))]),t.modalData.errors.length?e("Error",{attrs:{"error-array":t.modalData.errors},on:{"close-err":function(a){t.modalData.errors=[]}}}):t._e()],1),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"content"},[e("form",{staticClass:"form-horizontal"},[e("div",{staticClass:"form-group"},[t._m(1),e("div",{staticClass:"col-9 col-sm-12"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.modalData.name,expression:"modalData.name"}],staticClass:"form-input",attrs:{type:"text",id:"name",placeholder:"Name"},domProps:{value:t.modalData.name},on:{input:function(a){a.target.composing||t.$set(t.modalData,"name",a.target.value)}}})])]),e("div",{staticClass:"form-group"},[t._m(2),e("div",{staticClass:"col-9 col-sm-12"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.modalData.cmd,expression:"modalData.cmd"}],staticClass:"form-input",attrs:{type:"text",id:"cmd",placeholder:"Shell command"},domProps:{value:t.modalData.cmd},on:{input:function(a){a.target.composing||t.$set(t.modalData,"cmd",a.target.value)}}})])]),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.modalData.wait,expression:"modalData.wait"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.modalData.wait)?t._i(t.modalData.wait,null)>-1:t.modalData.wait},on:{change:function(a){var e=t.modalData.wait,s=a.target,i=!!s.checked;if(Array.isArray(e)){var o=null,r=t._i(e,o);s.checked?r<0&&t.$set(t.modalData,"wait",e.concat([o])):r>-1&&t.$set(t.modalData,"wait",e.slice(0,r).concat(e.slice(r+1)))}else t.$set(t.modalData,"wait",i)}}}),e("i",{staticClass:"form-icon"}),t._v("Wait for command output ")])])])])]),e("div",{staticClass:"modal-footer"},[e("button",{directives:[{name:"show",rawName:"v-show",value:-1!==t.modalData.id,expression:"modalData.id !== -1"}],staticClass:"btn btn-code float-left",attrs:{disabled:this.loading},on:{click:function(a){return t.modalAction(!0)}}},[e("i",{staticClass:"icon icon-delete"}),t._v(" Delete")]),e("button",{staticClass:"btn btn-primary",attrs:{disabled:this.loading},on:{click:function(a){return t.modalAction(!1)}}},[e("i",{staticClass:"icon icon-check"}),t._v(" Confirm")])])])]),e("div",{staticClass:"container"},[t.cmds.length||t.loading?e("div",{staticClass:"columns"},t._l(t.cmds,(function(a,s){return e("div",{key:a.id,staticClass:"column",class:[t.col]},[e("div",{staticClass:"tile tile-centered"},[e("div",{staticClass:"tile-icon"},[e("button",{staticClass:"btn btn-action btn-lg",class:{"btn-warning":a.running},on:{click:function(e){return t.execCmd(s,a.id)}}},[e("i",{staticClass:"icon icon-forward centered"})])]),e("div",{staticClass:"tile-content"},[e("div",{staticClass:"tile-title"},[t._v(t._s(a.name))]),e("div",{staticClass:"tile-subtitle text-gray"},[t._v(t._s(a.cmd))])]),e("div",{staticClass:"tile-action"},[e("button",{staticClass:"btn btn-link",on:{click:function(e){return t.openModal("Edit: "+a.name,a.id,a.name,a.cmd,a.wait)}}},[e("i",{staticClass:"icon icon-edit"})])])]),e("div",{directives:[{name:"show",rawName:"v-show",value:a.lastOutput,expression:"cmd.lastOutput"}],staticClass:"toast toast-success"},[e("button",{staticClass:"btn btn-clear float-right",on:{click:function(t){a.lastOutput=""}}}),t._v(" "+t._s(a.lastOutput)+" ")])])})),0):e("div",{staticClass:"empty centered"},[t._m(3),e("p",{staticClass:"empty-title h5"},[t._v("There are no cmds configured")]),e("p",{staticClass:"empty-subtitle"},[t._v("Click the button to configure new")]),e("div",{staticClass:"empty-action"},[e("button",{staticClass:"btn btn-primary",on:{click:function(a){return t.openModal("Add new cmd",-1,"","",!1)}}},[e("i",{staticClass:"icon icon-plus centered"})])])])])]),e("div",{staticClass:"panel-footer"},[e("span",{staticClass:"text-secondary"},[t._v("Last update: "+t._s(t.updateDate))])])])])},l=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"panel-title"},[e("h3",[t._v("Custom shell commands")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"name"}},[t._v("Name")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"col-3 col-sm-12"},[e("label",{staticClass:"form-label",attrs:{for:"cmd"}},[t._v("Command")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"empty-icon"},[e("i",{staticClass:"icon icon-4x icon-cross"})])}],n={name:"CustomCmds",data(){return{cmds:[],updateDate:"",modalData:{active:!1,id:-1,title:"New cmd",name:"",cmd:"",wait:!1,errors:[]}}},props:{col:{type:String,default:"col-4 col-lg-6 col-sm-12"}},created(){this.getCmds()},methods:{openModal(t,a,e,s,i){this.modalData.active=!0,this.modalData.title=t,this.modalData.name=e,this.modalData.cmd=s,this.modalData.wait=i,this.modalData.id=a,this.modalData.errors=[]},modalAction(t){if(this.modalData.errors=[],t||(this.modalData.name||this.modalData.errors.push("Name required !"),this.modalData.cmd||this.modalData.errors.push("Cmd required !")),!this.modalData.errors.length){let a="";a=t?"DeleteCustomCmd;"+this.modalData.id:-1===this.modalData.id?"AddCustomCmd;"+this.modalData.name+";"+this.modalData.cmd+";"+ +this.modalData.wait+";"+this.$moment.utc().format("YYYY-MM-DD HH:mm:ss.SSS"):"UpdateCustomCmd;"+this.modalData.id+";"+this.modalData.name+";"+this.modalData.cmd+";"+ +this.modalData.wait+";"+this.$moment.utc().format("YYYY-MM-DD HH:mm:ss.SSS"),this.doPost(a).then(()=>{this.getCmds(),this.modalData.active=!1}).catch(t=>{this.modalData.errors.push(t.message)})}},getCmds(){this.doPost("GetCustomCmds").then(t=>{this.$route.meta.error=null,this.cmds=[];for(var a=2;a<t.length-1;a+=4)this.cmds.push({id:parseInt(t[a]),name:t[a+1],cmd:t[a+2],wait:Boolean(parseInt(t[a+3])),running:!1,lastOutput:""});this.updateDate=this.$moment().format("YYYY-MM-DD HH:mm:ss.SSS")}).catch(t=>{this.$route.meta.error=t.message,this.$forceUpdate()})},execCmd(t,a){this.cmds[t].running=!0,this.doPost("ExecCustomCmd;"+a+";"+ +this.cmds[t].wait).then(a=>{this.$route.meta.error=null,this.cmds[t].running=!1,this.cmds[t].wait&&(this.cmds[t].lastOutput=a[2])}).catch(a=>{this.cmds[t].running=!1,this.$route.meta.error=a.message,this.$forceUpdate()})}},components:{Error:o["a"]}},c=n,m=e("2877"),d=Object(m["a"])(c,r,l,!1,null,null,null),u=d.exports,h=e("49a3"),p={name:"customcmds",components:{Error:o["a"],CustomCmds:u,History:h["a"]}},v=p,f=Object(m["a"])(v,s,i,!1,null,null,null);a["default"]=f.exports}}]);